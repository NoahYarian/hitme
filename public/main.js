"use strict";

var API = "http://deckofcardsapi.com/api/",
    $dealer1 = $(".dealer1"),
    $dealer2 = $(".dealer2"),
    $dealer3 = $(".dealer3"),
    $dealer4 = $(".dealer4"),
    $dealer5 = $(".dealer5"),
    $dealer6 = $(".dealer6"),
    $dealer7 = $(".dealer7"),
    $dealer8 = $(".dealer8"),
    $dealer9 = $(".dealer9"),
    $dealer10 = $(".dealer10"),
    $dealer11 = $(".dealer11"),
    $player1 = $(".player1"),
    $player2 = $(".player2"),
    $player3 = $(".player3"),
    $player4 = $(".player4"),
    $player5 = $(".player5"),
    $player6 = $(".player6"),
    $player7 = $(".player7"),
    $player8 = $(".player8"),
    $player9 = $(".player9"),
    $player10 = $(".player10"),
    $player11 = $(".player11"),
    deckId,
    $getDeck = $(".getDeck"),
    $dealCards = $(".dealCards"),
    $hit = $(".hit"),
    $stay = $(".stay"),
    dealerHand = [],
    playerHand = [];

var $dealer = $(".dealer");
var $player = $(".player");

var dealer = [];
var player = [];
var $dealerCard = $(".dealerCard");
var $playerCard = $(".playerCard");

$getDeck.click(sixDecks);
$dealCards.click(dealFour);
//$hit.click(hit);

function sixDecks() {
  var shuffleURL = API + "shuffle/?deck_count=6";
  console.log("shuffleURL = " + shuffleURL);
  getJSON(shuffleURL, function (data) {
    deckId = data.deck_id;
    console.log(deckId);
  });
};

function dealFour() {
  var draw4URL = API + "draw/" + deckId + "/?count=4";
  console.log("draw4URL = " + draw4URL);
  getJSON(draw4URL, function (data) {
    $dealer1.attr("src", "http://behance.vo.llnwd.net/profiles/56117/projects/5740089/e86ace60c0d4931bd3a89abe50b4d267.jpg");
    $player1.attr("src", data.cards[1].image);
    $dealer2.attr("src", data.cards[2].image);
    $player2.attr("src", data.cards[3].image);
    dealerHand.push(data.cards[0].value + " " + data.cards[0].suit);
    playerHand.push(data.cards[1].value + " " + data.cards[1].suit);
    dealerHand.push(data.cards[2].value + " " + data.cards[2].suit);
    playerHand.push(data.cards[3].value + " " + data.cards[3].suit);
  });
}

//function hit() {
//var hitURL = API + "/draw/" + deckId + "/?count=2";
//getJSON(hitURL, function(data) {
////var playerHtml = "  ("src", data.cards[0].image);
//$dealer3.attr("src", data.cards[1].image);
//playerHand.push(data.cards[0].value + " " + data.cards[0].suit);
//dealerHand.push(data.cards[1].value + " " + data.cards[1].suit);
//});
//}

$dealerCard.click(dealerCard);
$playerCard.click(playerCard);

function dealerCard() {
  var cardURL = API + "draw/" + deckId + "/?count=1";
  getJSON(cardURL, function (data) {
    var html = "<img class='cardImage' src='" + data.cards[0].image + "'>";
    $dealer.append(html);
    dealerHand.push(convertCard(data.cards[0].value));
  });
}

function playerCard() {
  var cardURL = API + "draw/" + deckId + "/?count=1";
  getJSON(cardURL, function (data) {
    var html = "<img class='cardImage' src='" + data.cards[0].image + "'>";
    $player.append(html);
    playerHand.push(convertCard(data.cards[0].value));
  });
}

function convertCard(value) {
  if (value === "ACE") {
    return 1;
  } else if (isNaN(value)) {
    return 10;
  } else {
    return value;
  }
}

function deal() {
  var deckId = sixDecks();
  debugger;
  dealerCard();
  playerCard();
  dealerCard();
  playerCard();
  $(".dealer:first-child").attr("src", "http://behance.vo.llnwd.net/profiles/56117/projects/5740089/e86ace60c0d4931bd3a89abe50b4d267.jpg");
}

// commented out until i figure out passing event handlers functions with arguments
//function card(person){
//var cardURL = API + "/draw/" + deckId + "/?count=1";
//var $person = ( person === 'dealer' ) ? $('.dealer') : $('.player');

//getJSON(cardURL, function(data) {
//var html = "<img class='cardImage' src='" + data.cards[0].image + "'>";
//$person.append(html);
//[person].push(data.cards[0].value);
//});
//}

// Scott's cross-origin fix
function getJSON(url, cb) {
  var JSONP_PROXY = "https://jsonp.afeld.me/?url=";
  // THIS WILL ADD THE CROSS ORIGIN HEADERS
  var request = new XMLHttpRequest();
  request.open("GET", JSONP_PROXY + url);
  request.onload = function () {
    if (request.status >= 200 && request.status < 400) {
      cb(JSON.parse(request.responseText));
    }
  };
  request.send();
}
//# sourceMappingURL=data:application/json;base64,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TyxDQUFDLENBQUM7R0FDVixNQUFNLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO0FBQ3ZCLFdBQU8sRUFBRSxDQUFDO0dBQ1gsTUFBTTtBQUNMLFdBQU8sS0FBSyxDQUFDO0dBQ2Q7Q0FDRjs7QUFFRCxTQUFTLElBQUksR0FBRztBQUNkLE1BQUksTUFBTSxHQUFHLFFBQVEsRUFBRSxDQUFDO0FBQ3hCLFdBQVM7QUFDVCxZQUFVLEVBQUUsQ0FBQztBQUNiLFlBQVUsRUFBRSxDQUFDO0FBQ2IsWUFBVSxFQUFFLENBQUM7QUFDYixZQUFVLEVBQUUsQ0FBQztBQUNiLEdBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsa0dBQWtHLENBQUMsQ0FBQztDQUMxSTs7Ozs7Ozs7Ozs7Ozs7O0FBZUQsU0FBUyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRTtBQUN4QixNQUFJLFdBQVcsR0FBRyw4QkFBOEIsQ0FBQTs7QUFFaEQsTUFBSSxPQUFPLEdBQUcsSUFBSSxjQUFjLEVBQUUsQ0FBQztBQUNuQyxTQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxXQUFXLEdBQUcsR0FBRyxDQUFDLENBQUM7QUFDdkMsU0FBTyxDQUFDLE1BQU0sR0FBRyxZQUFXO0FBQzFCLFFBQUksT0FBTyxDQUFDLE1BQU0sSUFBSSxHQUFHLElBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxHQUFHLEVBQUU7QUFDakQsUUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7S0FDdEM7R0FDRixDQUFDO0FBQ0YsU0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO0NBQ2hCIiwiZmlsZSI6InNyYy9tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEFQSSA9IFwiaHR0cDovL2RlY2tvZmNhcmRzYXBpLmNvbS9hcGkvXCIsXG4gICRkZWFsZXIxID0gJChcIi5kZWFsZXIxXCIpLFxuICAkZGVhbGVyMiA9ICQoXCIuZGVhbGVyMlwiKSxcbiAgJGRlYWxlcjMgPSAkKFwiLmRlYWxlcjNcIiksXG4gICRkZWFsZXI0ID0gJChcIi5kZWFsZXI0XCIpLFxuICAkZGVhbGVyNSA9ICQoXCIuZGVhbGVyNVwiKSxcbiAgJGRlYWxlcjYgPSAkKFwiLmRlYWxlcjZcIiksXG4gICRkZWFsZXI3ID0gJChcIi5kZWFsZXI3XCIpLFxuICAkZGVhbGVyOCA9ICQoXCIuZGVhbGVyOFwiKSxcbiAgJGRlYWxlcjkgPSAkKFwiLmRlYWxlcjlcIiksXG4gICRkZWFsZXIxMCA9ICQoXCIuZGVhbGVyMTBcIiksXG4gICRkZWFsZXIxMSA9ICQoXCIuZGVhbGVyMTFcIiksXG4gICRwbGF5ZXIxID0gJChcIi5wbGF5ZXIxXCIpLFxuICAkcGxheWVyMiA9ICQoXCIucGxheWVyMlwiKSxcbiAgJHBsYXllcjMgPSAkKFwiLnBsYXllcjNcIiksXG4gICRwbGF5ZXI0ID0gJChcIi5wbGF5ZXI0XCIpLFxuICAkcGxheWVyNSA9ICQoXCIucGxheWVyNVwiKSxcbiAgJHBsYXllcjYgPSAkKFwiLnBsYXllcjZcIiksXG4gICRwbGF5ZXI3ID0gJChcIi5wbGF5ZXI3XCIpLFxuICAkcGxheWVyOCA9ICQoXCIucGxheWVyOFwiKSxcbiAgJHBsYXllcjkgPSAkKFwiLnBsYXllcjlcIiksXG4gICRwbGF5ZXIxMCA9ICQoXCIucGxheWVyMTBcIiksXG4gICRwbGF5ZXIxMSA9ICQoXCIucGxheWVyMTFcIiksXG4gIGRlY2tJZCxcbiAgJGdldERlY2sgPSAkKFwiLmdldERlY2tcIiksXG4gICRkZWFsQ2FyZHMgPSAkKFwiLmRlYWxDYXJkc1wiKSxcbiAgJGhpdCA9ICQoXCIuaGl0XCIpLFxuICAkc3RheSA9ICQoXCIuc3RheVwiKSxcbiAgZGVhbGVySGFuZCA9IFtdLFxuICBwbGF5ZXJIYW5kID0gW107XG5cbnZhciAkZGVhbGVyID0gJChcIi5kZWFsZXJcIik7XG52YXIgJHBsYXllciA9ICQoXCIucGxheWVyXCIpO1xuXG52YXIgZGVhbGVyID0gW107XG52YXIgcGxheWVyID0gW107XG52YXIgJGRlYWxlckNhcmQgPSAkKFwiLmRlYWxlckNhcmRcIik7XG52YXIgJHBsYXllckNhcmQgPSAkKFwiLnBsYXllckNhcmRcIik7XG5cbiRnZXREZWNrLmNsaWNrKHNpeERlY2tzKTtcbiRkZWFsQ2FyZHMuY2xpY2soZGVhbEZvdXIpO1xuLy8kaGl0LmNsaWNrKGhpdCk7XG5cbmZ1bmN0aW9uIHNpeERlY2tzKCkge1xuICB2YXIgc2h1ZmZsZVVSTCA9IEFQSSArIFwic2h1ZmZsZS8/ZGVja19jb3VudD02XCI7XG4gIGNvbnNvbGUubG9nKFwic2h1ZmZsZVVSTCA9IFwiICsgc2h1ZmZsZVVSTCk7XG4gIGdldEpTT04oc2h1ZmZsZVVSTCwgZnVuY3Rpb24oZGF0YSkge1xuICAgIGRlY2tJZCA9IGRhdGEuZGVja19pZDtcbiAgICBjb25zb2xlLmxvZyhkZWNrSWQpO1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIGRlYWxGb3VyKCkge1xuICB2YXIgZHJhdzRVUkwgPSBBUEkgKyBcImRyYXcvXCIgKyBkZWNrSWQgKyBcIi8/Y291bnQ9NFwiO1xuICBjb25zb2xlLmxvZyhcImRyYXc0VVJMID0gXCIgKyBkcmF3NFVSTCk7XG4gIGdldEpTT04oZHJhdzRVUkwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAkZGVhbGVyMS5hdHRyKFwic3JjXCIsIFwiaHR0cDovL2JlaGFuY2Uudm8ubGxud2QubmV0L3Byb2ZpbGVzLzU2MTE3L3Byb2plY3RzLzU3NDAwODkvZTg2YWNlNjBjMGQ0OTMxYmQzYTg5YWJlNTBiNGQyNjcuanBnXCIpO1xuICAgICRwbGF5ZXIxLmF0dHIoXCJzcmNcIiwgZGF0YS5jYXJkc1sxXS5pbWFnZSk7XG4gICAgJGRlYWxlcjIuYXR0cihcInNyY1wiLCBkYXRhLmNhcmRzWzJdLmltYWdlKTtcbiAgICAkcGxheWVyMi5hdHRyKFwic3JjXCIsIGRhdGEuY2FyZHNbM10uaW1hZ2UpO1xuICAgIGRlYWxlckhhbmQucHVzaChkYXRhLmNhcmRzWzBdLnZhbHVlICsgXCIgXCIgKyBkYXRhLmNhcmRzWzBdLnN1aXQpO1xuICAgIHBsYXllckhhbmQucHVzaChkYXRhLmNhcmRzWzFdLnZhbHVlICsgXCIgXCIgKyBkYXRhLmNhcmRzWzFdLnN1aXQpO1xuICAgIGRlYWxlckhhbmQucHVzaChkYXRhLmNhcmRzWzJdLnZhbHVlICsgXCIgXCIgKyBkYXRhLmNhcmRzWzJdLnN1aXQpO1xuICAgIHBsYXllckhhbmQucHVzaChkYXRhLmNhcmRzWzNdLnZhbHVlICsgXCIgXCIgKyBkYXRhLmNhcmRzWzNdLnN1aXQpO1xuICB9KTtcbn1cblxuLy9mdW5jdGlvbiBoaXQoKSB7XG4gIC8vdmFyIGhpdFVSTCA9IEFQSSArIFwiL2RyYXcvXCIgKyBkZWNrSWQgKyBcIi8/Y291bnQ9MlwiO1xuICAvL2dldEpTT04oaGl0VVJMLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgLy8vL3ZhciBwbGF5ZXJIdG1sID0gXCIgIChcInNyY1wiLCBkYXRhLmNhcmRzWzBdLmltYWdlKTtcbiAgICAvLyRkZWFsZXIzLmF0dHIoXCJzcmNcIiwgZGF0YS5jYXJkc1sxXS5pbWFnZSk7XG4gICAgLy9wbGF5ZXJIYW5kLnB1c2goZGF0YS5jYXJkc1swXS52YWx1ZSArIFwiIFwiICsgZGF0YS5jYXJkc1swXS5zdWl0KTtcbiAgICAvL2RlYWxlckhhbmQucHVzaChkYXRhLmNhcmRzWzFdLnZhbHVlICsgXCIgXCIgKyBkYXRhLmNhcmRzWzFdLnN1aXQpO1xuICAvL30pO1xuLy99XG5cbiRkZWFsZXJDYXJkLmNsaWNrKGRlYWxlckNhcmQpO1xuJHBsYXllckNhcmQuY2xpY2socGxheWVyQ2FyZCk7XG5cbmZ1bmN0aW9uIGRlYWxlckNhcmQoKXtcbiAgdmFyIGNhcmRVUkwgPSBBUEkgKyBcImRyYXcvXCIgKyBkZWNrSWQgKyBcIi8/Y291bnQ9MVwiO1xuICBnZXRKU09OKGNhcmRVUkwsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB2YXIgaHRtbCA9IFwiPGltZyBjbGFzcz0nY2FyZEltYWdlJyBzcmM9J1wiICsgZGF0YS5jYXJkc1swXS5pbWFnZSArIFwiJz5cIjtcbiAgICAkZGVhbGVyLmFwcGVuZChodG1sKTtcbiAgICBkZWFsZXJIYW5kLnB1c2goY29udmVydENhcmQoZGF0YS5jYXJkc1swXS52YWx1ZSkpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcGxheWVyQ2FyZCgpe1xuICB2YXIgY2FyZFVSTCA9IEFQSSArIFwiZHJhdy9cIiArIGRlY2tJZCArIFwiLz9jb3VudD0xXCI7XG4gIGdldEpTT04oY2FyZFVSTCwgZnVuY3Rpb24oZGF0YSkge1xuICAgIHZhciBodG1sID0gXCI8aW1nIGNsYXNzPSdjYXJkSW1hZ2UnIHNyYz0nXCIgKyBkYXRhLmNhcmRzWzBdLmltYWdlICsgXCInPlwiO1xuICAgICRwbGF5ZXIuYXBwZW5kKGh0bWwpO1xuICAgIHBsYXllckhhbmQucHVzaChjb252ZXJ0Q2FyZChkYXRhLmNhcmRzWzBdLnZhbHVlKSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjb252ZXJ0Q2FyZCh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT09IFwiQUNFXCIpIHtcbiAgICByZXR1cm4gMTtcbiAgfSBlbHNlIGlmIChpc05hTih2YWx1ZSkpIHtcbiAgICByZXR1cm4gMTA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRlYWwoKSB7XG4gIHZhciBkZWNrSWQgPSBzaXhEZWNrcygpO1xuICBkZWJ1Z2dlcjtcbiAgZGVhbGVyQ2FyZCgpO1xuICBwbGF5ZXJDYXJkKCk7XG4gIGRlYWxlckNhcmQoKTtcbiAgcGxheWVyQ2FyZCgpO1xuICAkKFwiLmRlYWxlcjpmaXJzdC1jaGlsZFwiKS5hdHRyKFwic3JjXCIsIFwiaHR0cDovL2JlaGFuY2Uudm8ubGxud2QubmV0L3Byb2ZpbGVzLzU2MTE3L3Byb2plY3RzLzU3NDAwODkvZTg2YWNlNjBjMGQ0OTMxYmQzYTg5YWJlNTBiNGQyNjcuanBnXCIpO1xufVxuXG4vLyBjb21tZW50ZWQgb3V0IHVudGlsIGkgZmlndXJlIG91dCBwYXNzaW5nIGV2ZW50IGhhbmRsZXJzIGZ1bmN0aW9ucyB3aXRoIGFyZ3VtZW50c1xuLy9mdW5jdGlvbiBjYXJkKHBlcnNvbil7XG4gIC8vdmFyIGNhcmRVUkwgPSBBUEkgKyBcIi9kcmF3L1wiICsgZGVja0lkICsgXCIvP2NvdW50PTFcIjtcbiAgLy92YXIgJHBlcnNvbiA9ICggcGVyc29uID09PSAnZGVhbGVyJyApID8gJCgnLmRlYWxlcicpIDogJCgnLnBsYXllcicpO1xuXG4gIC8vZ2V0SlNPTihjYXJkVVJMLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgLy92YXIgaHRtbCA9IFwiPGltZyBjbGFzcz0nY2FyZEltYWdlJyBzcmM9J1wiICsgZGF0YS5jYXJkc1swXS5pbWFnZSArIFwiJz5cIjtcbiAgICAvLyRwZXJzb24uYXBwZW5kKGh0bWwpO1xuICAgIC8vW3BlcnNvbl0ucHVzaChkYXRhLmNhcmRzWzBdLnZhbHVlKTtcbiAgLy99KTtcbi8vfVxuXG4vLyBTY290dCdzIGNyb3NzLW9yaWdpbiBmaXhcbmZ1bmN0aW9uIGdldEpTT04odXJsLCBjYikge1xuICB2YXIgSlNPTlBfUFJPWFkgPSAnaHR0cHM6Ly9qc29ucC5hZmVsZC5tZS8/dXJsPSdcbiAgLy8gVEhJUyBXSUxMIEFERCBUSEUgQ1JPU1MgT1JJR0lOIEhFQURFUlNcbiAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgcmVxdWVzdC5vcGVuKCdHRVQnLCBKU09OUF9QUk9YWSArIHVybCk7XG4gIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHJlcXVlc3Quc3RhdHVzID49IDIwMCAmJiByZXF1ZXN0LnN0YXR1cyA8IDQwMCkge1xuICAgICAgY2IoSlNPTi5wYXJzZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCkpO1xuICAgIH1cbiAgfTtcbiAgcmVxdWVzdC5zZW5kKCk7XG59XG4iXX0=